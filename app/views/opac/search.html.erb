<script>
$(function () {
  //keypad
  var specials  = [
    $.keypad.SPACE_BAR,
    $.keypad.BACK,
    $.keypad.CLEAR
  ];

  var kana = [
     'ャァワラヤマハナタサカア',
     'ュィヲリ　ミヒニチシキイ',
     'ョゥンルユムフヌツスクウ',
     'ッェﾟレ　メヘネテセケエ',
     'ーォ゛ロヨモホノトソコオ',
  ];
/**
  var alnum = [
    'ABCDEFGHIJKL',
    'MNOPQRSTUVWX',
    'YZ0123456789',
    '*?!&:;-/()[]',
    '.,+@%       ',
  ];
**/
  var alnum = [
    'ABCDEFGHI123',
    'JKLMNOPQR456',
    'STUVWXYZ@789',
    '?!&:;~-_/*0#',
    '"()[].,+=|$%',
  ];
  //focus
  $('#query').focus();


  $('#keys_area').keypad({
    layout: kana,
    target: $('.text-field'),
    //target: $(':focus'),
    keypadOnly: false,
  });

  $('#special_keys_area').keypad({
    layout: specials,
    target: $('.text-field'),
    //target: $(':focus'),
    spacebarText : "<%= t('opac.search.keypad.space') %>",
    clearText    : "<%= t('opac.search.keypad.clear') %>",
    backText     : "<%= t('opac.search.keypad.back') %>",
    beforeShow : function(inst){
      $('.keypad-kana').click(function(){
        $('#keys_area').html('');
        $('#keys_area').keypad({
          target: $('.text-field'),
          //target: $(':focus'),
          layout: kana
        });
      });
      $('.keypad-alnum').click(function(){
        $('#keys_area').html('');
        $('#keys_area').keypad({
          target: $('.text-field'),
          //target: $(':focus'),
          layout: alnum
        });
      });
    }
  });
});
</script>

<div id="opac_header">
  <div class="opac_title"><h1><%= t('opac.catalog_search') %></h1></div>
  <div class="opac_head_button_area">
    <%= link_to opac_path do %><div class="opac_head_button"><%= t('opac.finish') %></div><% end %>
  </div>
</div>

<div id="opac_content_detail">
  <div id="opac_search">
    <%= form_tag({:controller => 'manifestations'}, {:method => 'get'}) do -%>
      <h3><%= t('opac.search.input_keyword') %></h3>
      <table>
        <tr>
          <td><%= t('page.search_term') %>:</td>
          <td><%= search_field_tag 'query', nil, :class => 'text-field' %></td>
        </tr>
<% if false %>
        <tr>
          <td><%= t('patron.creator') %>:</td>
          <td><%= search_field_tag 'creator', nil, :class => 'text-field' %></td>
        </tr>
        <tr>
          <td><%= t('patron.publisher') %>:</td>
          <td><%= search_field_tag 'publisher', nil, :class => 'text-field' %></td>
        </tr>
        <tr>
          <td><%= t('activerecord.attributes.manifestation.date_of_publication') %>:</td>
          <td>
            <%= search_field_tag 'pub_date_from', nil, :class => 'date-text-field',
              :placeholder => "#{t('page.example')}: 1978, 1978-04-12" %>
             - 
            <%= search_field_tag 'pub_date_to', nil, :class => 'date-text-field',
              :placeholder => "#{t('page.example')}: 2011, 2011-04-12" %>
         </td>
        </tr>
<% end %>
      </table>
      <%= hidden_field_tag 'opac', 'true' %>
      <%= submit_tag t('page.search'), :class => 'opac_search_button' %><br />
    <% end %>
  </div>
  <br />
  <div id="keypad">
    <div id="special_keys_area">
      <div><button class="keypad-special keypad-kana"><%= t('opac.search.keypad.kana') %></button></div>
      <div><button class="keypad-special keypad-alnum"><%= t('opac.search.keypad.alnum') %></button></div>
    </div>
    <div id="keys_area"></div>
    <br style="cleat:both;"/>
  </div>
</div>
